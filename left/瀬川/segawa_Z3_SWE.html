<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>segawa_vanish_Z3_SWE</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      background: #f4f4f4;
      -webkit-text-size-adjust: 100%;
    }
    .page-wrapper {
      padding: 10px 12px 16px 12px;
    }
    .top-row {
      display: flex;
      flex-direction: row;
      align-items: stretch;
      gap: 10px;
    }
    #plotArea {
      flex: 1 1 auto;
      min-width: 0;
      height: 75vh;
    }
    #plot {
      width: 100%;
      height: 100%;
    }
    #trialPanel {
      width: 120px;
      padding-left: 0px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      align-items: flex-start;
      justify-content: flex-start;
    }
    .trial-btn {
      width: 100%;
      padding: 8px 6px;
      margin: 0;
      border-radius: 10px;
      border: 1px solid #1976d2;
      background: #fff;
      color: #1976d2;
      cursor: pointer;
      font-size: 14px;
      touch-action: manipulation;
    }
    .trial-btn.active {
      background: #1976d2;
      color: #fff;
    }

    #bottomPanel {
      margin-top: 10px;
      padding: 10px 12px 12px 12px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    #frameLabel {
      font-size: 14px;
      line-height: 1.2;
    }

    /* --- Mobile friendly slider --- */
    #frameSlider {
      width: 100%;
      height: 44px;          /* タップ領域 */
      margin: 0;
      background: transparent;
      touch-action: manipulation;
    }
    /* iOS/Safari */
    #frameSlider::-webkit-slider-runnable-track {
      height: 10px;
      border-radius: 999px;
      background: #d0d0d0;
    }
    #frameSlider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 34px;
      height: 34px;
      border-radius: 50%;
      background: #1976d2;
      border: 2px solid #fff;
      margin-top: -12px; /* track中央 */
    }
    /* Firefox */
    #frameSlider::-moz-range-track {
      height: 10px;
      border-radius: 999px;
      background: #d0d0d0;
    }
    #frameSlider::-moz-range-thumb {
      width: 34px;
      height: 34px;
      border-radius: 50%;
      background: #1976d2;
      border: 2px solid #fff;
    }

    .step-btn {
      height: 44px;
      min-width: 64px;
      font-size: 18px;
      border-radius: 10px;
      border: 1px solid #1976d2;
      background: #fff;
      color: #1976d2;
      touch-action: manipulation;
    }
    .step-btn:active {
      transform: scale(0.98);
    }

    /* スマホ縦向きで右パネルを下に回す */
    @media (max-width: 700px) {
      .top-row {
        flex-direction: column;
      }
      #trialPanel {
        width: 100%;
        flex-direction: row;
        flex-wrap: wrap;
        gap: 8px;
      }
      .trial-btn {
        width: auto;
        min-width: 80px;
      }
      #plotArea {
        height: 60vh;
      }
    }
  </style>
</head>
<body>
  <div class="page-wrapper">
    <div class="top-row">
      <div id="plotArea">
        <div id="plot"></div>
      </div>
      <div id="trialPanel">
        <div style="font-weight:bold; margin-bottom:4px;">Trial</div>
        <button class="trial-btn" id="trialBtn_1" data-trial="1">1球目</button>
          <button class="trial-btn" id="trialBtn_2" data-trial="2">2球目</button>
          <button class="trial-btn" id="trialBtn_3" data-trial="3">3球目</button>
      </div>
    </div>

    <div id="bottomPanel">
      <div id="frameLabel">Frame:</div>
      <div style="display:flex; gap:10px; align-items:center;">
        <button id="prevBtn" class="step-btn">-</button>
        <input type="range" id="frameSlider" min="0" max="0" value="0" step="1">
        <button id="nextBtn" class="step-btn">+</button>
      </div>
    </div>
  </div>

  <script>
    // Python から渡された Figure & Trial 情報
    const fig = {"data": [{"legendgroup": "StrikeZone", "line": {"color": "blue", "width": 3}, "mode": "lines", "name": "SZ Bottom", "showlegend": true, "x": [0.3002845, 0.3002845, 0.150155, 2.548099e-05, 0.150155, 0.3002845], "y": [0.150414, -0.150414, -0.150414, -0.0, 0.150414, 0.150414], "z": [-0.3406982, -0.3406982, -0.3406982, -0.3406982, -0.3406982, -0.3406982], "type": "scatter3d"}, {"legendgroup": "StrikeZone", "line": {"color": "blue", "width": 3}, "mode": "lines", "name": "SZ Top", "showlegend": true, "x": [0.3002845, 0.3002845, 0.150155, 2.548099e-05, 0.150155, 0.3002845], "y": [0.150414, -0.150414, -0.150414, -0.0, 0.150414, 0.150414], "z": [0.0893752, 0.0893752, 0.0893752, 0.0893752, 0.0893752, 0.0893752], "type": "scatter3d"}, {"legendgroup": "StrikeZone", "line": {"color": "blue", "width": 2.5}, "mode": "lines", "name": "SZ Side", "opacity": 0.3, "showlegend": true, "x": [0.3002845, 0.3002845], "y": [0.150414, 0.150414], "z": [-0.3406982, 0.0893752], "type": "scatter3d"}, {"legendgroup": "StrikeZone", "line": {"color": "blue", "width": 2.5}, "mode": "lines", "opacity": 0.3, "showlegend": false, "x": [0.3002845, 0.3002845], "y": [-0.150414, -0.150414], "z": [-0.3406982, 0.0893752], "type": "scatter3d"}, {"legendgroup": "StrikeZone", "line": {"color": "blue", "width": 2.5}, "mode": "lines", "opacity": 0.3, "showlegend": false, "x": [0.150155, 0.150155], "y": [-0.150414, -0.150414], "z": [-0.3406982, 0.0893752], "type": "scatter3d"}, {"legendgroup": "StrikeZone", "line": {"color": "blue", "width": 2.5}, "mode": "lines", "opacity": 0.3, "showlegend": false, "x": [2.548099e-05, 2.548099e-05], "y": [-0.0, -0.0], "z": [-0.3406982, 0.0893752], "type": "scatter3d"}, {"legendgroup": "StrikeZone", "line": {"color": "blue", "width": 2.5}, "mode": "lines", "opacity": 0.3, "showlegend": false, "x": [0.150155, 0.150155], "y": [0.150414, 0.150414], "z": [-0.3406982, 0.0893752], "type": "scatter3d"}, {"legendgroup": "StrikeZone", "marker": {"color": "white", "line": {"color": "blue", "width": 1}, "size": 5}, "mode": "markers+text", "name": "NineGrid", "showlegend": false, "text": ["Z1", "Z2", "Z3", "Z4", "Z5", "Z6", "Z7", "Z8", "Z9"], "textposition": "top center", "x": [0.3002845, 0.3002845, 0.3002845, 0.3002845, 0.3002845, 0.3002845, 0.3002845, 0.3002845, 0.3002845], "y": [0.100276, -0.0, -0.100276, 0.100276, -0.0, -0.100276, 0.100276, -0.0, -0.100276], "z": [0.01769632, 0.01769632, 0.01769632, -0.1256615, -0.1256615, -0.1256615, -0.2690193, -0.2690193, -0.2690193], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "name": "Bat", "showlegend": true, "x": [0.0505852289497852, -0.151091754436493], "y": [0.000777967274188995, -0.678266286849976], "z": [-0.0933855548501015, 0.278400957584381], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "name": "BOTTOM", "showlegend": true, "x": [-0.151091754436493], "y": [-0.678266286849976], "z": [0.278400957584381], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "name": "Sweet Spot", "showlegend": true, "x": [0.025375604362567226], "y": [-0.08410257009377697], "z": [-0.04691223772837164], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "name": "Ball", "showlegend": true, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "name": "S\u2192P", "showlegend": true, "x": [0.025375604362567226, 0.154346406459808], "y": [-0.08410257009377697, -0.100275993347168], "z": [-0.04691223772837164, 0.0399786829948425], "type": "scatter3d"}], "layout": {"template": {"data": {"histogram2dcontour": [{"type": "histogram2dcontour", "colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}], "choropleth": [{"type": "choropleth", "colorbar": {"outlinewidth": 0, "ticks": ""}}], "histogram2d": [{"type": "histogram2d", "colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}], "heatmap": [{"type": "heatmap", "colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}], "heatmapgl": [{"type": "heatmapgl", "colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}], "contourcarpet": [{"type": "contourcarpet", "colorbar": {"outlinewidth": 0, "ticks": ""}}], "contour": [{"type": "contour", "colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}], "surface": [{"type": "surface", "colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}], "mesh3d": [{"type": "mesh3d", "colorbar": {"outlinewidth": 0, "ticks": ""}}], "scatter": [{"fillpattern": {"fillmode": "overlay", "size": 10, "solidity": 0.2}, "type": "scatter"}], "parcoords": [{"type": "parcoords", "line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}], "scatterpolargl": [{"type": "scatterpolargl", "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}], "bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}, "pattern": {"fillmode": "overlay", "size": 10, "solidity": 0.2}}, "type": "bar"}], "scattergeo": [{"type": "scattergeo", "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}], "scatterpolar": [{"type": "scatterpolar", "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}], "histogram": [{"marker": {"pattern": {"fillmode": "overlay", "size": 10, "solidity": 0.2}}, "type": "histogram"}], "scattergl": [{"type": "scattergl", "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}], "scatter3d": [{"type": "scatter3d", "line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}], "scattermapbox": [{"type": "scattermapbox", "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}], "scatterternary": [{"type": "scatterternary", "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}], "scattercarpet": [{"type": "scattercarpet", "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}, "pattern": {"fillmode": "overlay", "size": 10, "solidity": 0.2}}, "type": "barpolar"}], "pie": [{"automargin": true, "type": "pie"}]}, "layout": {"autotypenumbers": "strict", "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "hovermode": "closest", "hoverlabel": {"align": "left"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"bgcolor": "#E5ECF6", "angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "ternary": {"bgcolor": "#E5ECF6", "aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]]}, "xaxis": {"gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "automargin": true, "zerolinewidth": 2}, "yaxis": {"gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "automargin": true, "zerolinewidth": 2}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white", "gridwidth": 2}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white", "gridwidth": 2}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white", "gridwidth": 2}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "geo": {"bgcolor": "white", "landcolor": "#E5ECF6", "subunitcolor": "white", "showland": true, "showlakes": true, "lakecolor": "white"}, "title": {"x": 0.05}, "mapbox": {"style": "light"}}}, "scene": {"camera": {"eye": {"x": 1.6, "y": 1.6, "z": 1.0}, "center": {"x": 0, "y": 0, "z": 0}, "up": {"x": 0, "y": 0, "z": 1}}, "xaxis": {"title": {"text": "\u6a2a Z [m]"}}, "yaxis": {"title": {"text": "\u5965\u884c X [m]"}}, "zaxis": {"title": {"text": "\u7e26 Y [m]"}}, "aspectmode": "data"}, "margin": {"l": 0, "r": 0, "t": 60, "b": 120}, "legend": {"itemsizing": "constant", "groupclick": "togglegroup"}, "title": {"text": "Z3 (Z3) / trial 1 / index -2 (MIN=-2)  |  offset=10 cm from TOP  \u203bframe\u79fb\u52d5\u3067\u30ab\u30e1\u30e9\u4fdd\u6301"}, "uirevision": "Z3_keep_camera"}, "frames": [{"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [-0.895212113857269, -0.119316212832928], "y": [-0.162416994571686, -0.316359609365463], "z": [0.0966341570019722, 0.216163128614426], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.119316212832928], "y": [-0.316359609365463], "z": [0.216163128614426], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [-0.7982251226627305], "y": [-0.1816598221285233], "z": [0.11157527900295777], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [-0.7982251226627305, 0.154346406459808], "y": [-0.1816598221285233, -0.100275993347168], "z": [0.11157527900295777, 0.0399786829948425], "type": "scatter3d"}], "name": "T1_I-7", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [-0.76307600736618, -0.0734409838914871], "y": [-0.0831463783979416, -0.393532454967499], "z": [-0.0120902732014656, 0.248800739645958], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.0734409838914871], "y": [-0.393532454967499], "z": [0.248800739645958], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [-0.6768716363494568], "y": [-0.12194463485570552], "z": [0.02052110078750828], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [-0.6768716363494568, 0.154346406459808], "y": [-0.12194463485570552, -0.100275993347168], "z": [0.02052110078750828, 0.0399786829948425], "type": "scatter3d"}], "name": "T1_I-6", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [-0.606392800807953, -0.0832178890705109], "y": [0.00300543010234833, -0.489009439945221], "z": [-0.0743990391492844, 0.27803435921669], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.0832178890705109], "y": [-0.489009439945221], "z": [0.27803435921669], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [-0.5409959327996139], "y": [-0.058496432454067285], "z": [-0.03034486163123703], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [-0.5409959327996139, 0.154346406459808], "y": [-0.058496432454067285, -0.100275993347168], "z": [-0.03034486163123703, 0.0399786829948425], "type": "scatter3d"}], "name": "T1_I-5", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [-0.405448913574219, -0.081691637635231], "y": [0.0287883151322603, -0.562211751937866], "z": [-0.137350469827652, 0.293811053037643], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.081691637635231], "y": [-0.562211751937866], "z": [0.293811053037643], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [-0.3649792576166121], "y": [-0.04508668679899484], "z": [-0.08345528417689116], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [-0.3649792576166121, 0.154346406459808], "y": [-0.04508668679899484, -0.100275993347168], "z": [-0.08345528417689116, 0.0399786829948425], "type": "scatter3d"}], "name": "T1_I-4", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [-0.174155712127686, -0.0945487022399902], "y": [0.00892502814531326, -0.633783042430878], "z": [-0.168205291032791, 0.301463752985001], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.0945487022399902], "y": [-0.633783042430878], "z": [0.301463752985001], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [-0.164204835510136], "y": [-0.07141348375746565], "z": [-0.10949665827925678], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [-0.164204835510136, 0.154346406459808], "y": [-0.07141348375746565, -0.100275993347168], "z": [-0.10949665827925678, 0.0399786829948425], "type": "scatter3d"}], "name": "T1_I-3", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.0505852289497852, -0.151091754436493], "y": [0.000777967274188995, -0.678266286849976], "z": [-0.0933855548501015, 0.278400957584381], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.151091754436493], "y": [-0.678266286849976], "z": [0.278400957584381], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.025375604362567226], "y": [-0.08410257009377697], "z": [-0.04691223772837164], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.025375604362567226, 0.154346406459808], "y": [-0.08410257009377697, -0.100275993347168], "z": [-0.04691223772837164, 0.0399786829948425], "type": "scatter3d"}], "name": "T1_I-2", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.256518244743347, -0.159176155924797], "y": [-0.18627992272377, -0.740661263465881], "z": [-0.119528919458389, 0.2802954018116], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.159176155924797], "y": [-0.740661263465881], "z": [0.2802954018116], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.20455644439956838], "y": [-0.2555775906636245], "z": [-0.06955087904931581], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.20455644439956838, 0.154346406459808], "y": [-0.2555775906636245, -0.100275993347168], "z": [-0.06955087904931581, 0.0399786829948425], "type": "scatter3d"}], "name": "T1_I-1", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.256518244743347, -0.159176155924797], "y": [-0.18627992272377, -0.740661263465881], "z": [-0.119528919458389, 0.2802954018116], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.159176155924797], "y": [-0.740661263465881], "z": [0.2802954018116], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.20455644439956838], "y": [-0.2555775906636245], "z": [-0.06955087904931581], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.20455644439956838, 0.154346406459808], "y": [-0.2555775906636245, -0.100275993347168], "z": [-0.06955087904931581, 0.0399786829948425], "type": "scatter3d"}], "name": "T1_I0", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.471057653427124, -0.243849337100983], "y": [-0.418500304222107, -0.720983743667603], "z": [0.00739078596234322, 0.200812697410583], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.243849337100983], "y": [-0.720983743667603], "z": [0.200812697410583], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.38169429860591964], "y": [-0.45631072611592316], "z": [0.031568519754226], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.38169429860591964, 0.154346406459808], "y": [-0.45631072611592316, -0.100275993347168], "z": [0.031568519754226, 0.0399786829948425], "type": "scatter3d"}], "name": "T1_I1", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.518121302127838, -0.266292572021484], "y": [-0.640363991260529, -0.710314691066742], "z": [0.0225591622292995, 0.163279086351395], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.266292572021484], "y": [-0.710314691066742], "z": [0.163279086351395], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.42006959263302607], "y": [-0.6491078265270785], "z": [0.040149148300256114], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.42006959263302607, 0.154346406459808], "y": [-0.6491078265270785, -0.100275993347168], "z": [0.040149148300256114, 0.0399786829948425], "type": "scatter3d"}], "name": "T1_I2", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.498367667198181, -0.276093602180481], "y": [-0.845126867294312, -0.679124236106873], "z": [0.0133156627416611, 0.125801846385002], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.276093602180481], "y": [-0.679124236106873], "z": [0.125801846385002], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.4015600291609541], "y": [-0.8243765428189334], "z": [0.027376432699944574], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.4015600291609541, 0.154346406459808], "y": [-0.8243765428189334, -0.100275993347168], "z": [0.027376432699944574, 0.0399786829948425], "type": "scatter3d"}], "name": "T1_I3", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [-0.267558395862579, 0.0746280252933502], "y": [0.0767948627471924, -0.581761360168457], "z": [-0.0696972608566284, 0.22898668050766], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [0.0746280252933502], "y": [-0.581761360168457], "z": [0.22898668050766], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [-0.2247850912930664], "y": [-0.005524668822071421], "z": [-0.032361766505800665], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [-0.2247850912930664, 0.154346406459808], "y": [-0.005524668822071421, -0.100275993347168], "z": [-0.032361766505800665, 0.0399786829948425], "type": "scatter3d"}], "name": "T2_I-4", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [-0.144820958375931, 0.0585962384939194], "y": [0.0928208231925964, -0.62770676612854], "z": [-0.0525492839515209, 0.229339465498924], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [0.0585962384939194], "y": [-0.62770676612854], "z": [0.229339465498924], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [-0.11939380539059377], "y": [0.0027548625671197785], "z": [-0.017313185591027694], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [-0.11939380539059377, 0.154346406459808], "y": [0.0027548625671197785, -0.100275993347168], "z": [-0.017313185591027694, 0.0399786829948425], "type": "scatter3d"}], "name": "T2_I-3", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [-0.0159511957317591, 0.052836686372757], "y": [0.0756639242172241, -0.669066846370697], "z": [-0.0528384819626808, 0.231140866875648], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [0.052836686372757], "y": [-0.669066846370697], "z": [0.231140866875648], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [-0.0073527102265366785], "y": [-0.017427424727984295], "z": [-0.01734106235818099], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [-0.0073527102265366785, 0.154346406459808], "y": [-0.017427424727984295, -0.100275993347168], "z": [-0.01734106235818099, 0.0399786829948425], "type": "scatter3d"}], "name": "T2_I-2", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.111381843686104, 0.0432614162564278], "y": [0.0429030172526836, -0.705097317695618], "z": [-0.0441666729748249, 0.231251284480095], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [0.0432614162564278], "y": [-0.705097317695618], "z": [0.231251284480095], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.10286678989154394], "y": [-0.05059702863309731], "z": [-0.009739426813788227], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.10286678989154394, 0.154346406459808], "y": [-0.05059702863309731, -0.100275993347168], "z": [-0.009739426813788227, 0.0399786829948425], "type": "scatter3d"}], "name": "T2_I-1", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.111381843686104, 0.0432614162564278], "y": [0.0429030172526836, -0.705097317695618], "z": [-0.0441666729748249, 0.231251284480095], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [0.0432614162564278], "y": [-0.705097317695618], "z": [0.231251284480095], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.10286678989154394], "y": [-0.05059702863309731], "z": [-0.009739426813788227], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.10286678989154394, 0.154346406459808], "y": [-0.05059702863309731, -0.100275993347168], "z": [-0.009739426813788227, 0.0399786829948425], "type": "scatter3d"}], "name": "T2_I0", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.231129676103592, 0.0189349595457315], "y": [0.00523339956998825, -0.7316575050354], "z": [-0.00266774371266365, 0.225290879607201], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [0.0189349595457315], "y": [-0.7316575050354], "z": [0.225290879607201], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.20460533522776575], "y": [-0.08687796804137103], "z": [0.025827085605442574], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.20460533522776575, 0.154346406459808], "y": [-0.08687796804137103, -0.100275993347168], "z": [0.025827085605442574, 0.0399786829948425], "type": "scatter3d"}], "name": "T2_I1", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.346070051193237, 0.00589682348072529], "y": [-0.0665959715843201, -0.760163962841034], "z": [0.0137860970571637, 0.221741691231728], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [0.00589682348072529], "y": [-0.760163962841034], "z": [0.221741691231728], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.30354839482231005], "y": [-0.15329197641811657], "z": [0.03978054810601538], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.30354839482231005, 0.154346406459808], "y": [-0.15329197641811657, -0.100275993347168], "z": [0.03978054810601538, 0.0399786829948425], "type": "scatter3d"}], "name": "T2_I2", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.44548887014389, -0.0159977544099092], "y": [-0.139190793037415, -0.771404683589935], "z": [0.0477892979979515, 0.213124364614487], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.0159977544099092], "y": [-0.771404683589935], "z": [0.213124364614487], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.3878030417277708], "y": [-0.21821752983170806], "z": [0.06845618144929895], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.3878030417277708, 0.154346406459808], "y": [-0.21821752983170806, -0.100275993347168], "z": [0.06845618144929895, 0.0399786829948425], "type": "scatter3d"}], "name": "T2_I3", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.532477855682373, -0.0332111045718193], "y": [-0.240490972995758, -0.788089573383331], "z": [0.063383474946022, 0.205269739031792], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.0332111045718193], "y": [-0.788089573383331], "z": [0.205269739031792], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.46176673227171844], "y": [-0.3089408013150308], "z": [0.08111925880423503], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.46176673227171844, 0.154346406459808], "y": [-0.3089408013150308, -0.100275993347168], "z": [0.08111925880423503, 0.0399786829948425], "type": "scatter3d"}], "name": "T2_I4", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.600832402706146, -0.0509615801274776], "y": [-0.354001224040985, -0.800457894802094], "z": [0.070013590157032, 0.195874363183975], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.0509615801274776], "y": [-0.800457894802094], "z": [0.195874363183975], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.5193581477937358], "y": [-0.40980831272075513], "z": [0.08574618814833271], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.5193581477937358, 0.154346406459808], "y": [-0.40980831272075513, -0.100275993347168], "z": [0.08574618814833271, 0.0399786829948425], "type": "scatter3d"}], "name": "T2_I5", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.650049924850464, -0.0749738812446594], "y": [-0.457476377487183, -0.783002257347107], "z": [0.0865761265158653, 0.178084164857864], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.0749738812446594], "y": [-0.783002257347107], "z": [0.178084164857864], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.559421973086883], "y": [-0.49816710169475725], "z": [0.09801462827969636], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0399786829948425], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.559421973086883, 0.154346406459808], "y": [-0.49816710169475725, -0.100275993347168], "z": [0.09801462827969636, 0.0399786829948425], "type": "scatter3d"}], "name": "T2_I6", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [-0.781206250190735, -0.026329830288887], "y": [-0.184318259358406, -0.343541741371155], "z": [0.0242182798683643, 0.235901728272438], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.026329830288887], "y": [-0.343541741371155], "z": [0.235901728272438], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [-0.6868467278446989], "y": [-0.20422118825231578], "z": [0.05067870246649937], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0176963210105896], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [-0.6868467278446989, 0.154346406459808], "y": [-0.20422118825231578, -0.100275993347168], "z": [0.05067870246649937, 0.0176963210105896], "type": "scatter3d"}], "name": "T3_I-6", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [-0.622530043125153, 0.0196475125849247], "y": [-0.118804417550564, -0.429133683443069], "z": [-0.0891558676958084, 0.273202747106552], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [0.0196475125849247], "y": [-0.429133683443069], "z": [0.273202747106552], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [-0.5422578506712482], "y": [-0.15759557481587427], "z": [-0.043861041979605046], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0176963210105896], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [-0.5422578506712482, 0.154346406459808], "y": [-0.15759557481587427, -0.100275993347168], "z": [-0.043861041979605046, 0.0176963210105896], "type": "scatter3d"}], "name": "T3_I-5", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [-0.454939037561417, 0.00205851159989834], "y": [-0.0626710504293442, -0.5339115858078], "z": [-0.157824978232384, 0.29943373799324], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [0.00205851159989834], "y": [-0.5339115858078], "z": [0.29943373799324], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [-0.3978143410460725], "y": [-0.12157612031128456], "z": [-0.10066763583236064], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0176963210105896], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [-0.3978143410460725, 0.154346406459808], "y": [-0.12157612031128456, -0.100275993347168], "z": [-0.10066763583236064, 0.0176963210105896], "type": "scatter3d"}], "name": "T3_I-4", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [-0.241650983691216, -0.00282812025398016], "y": [-0.0652865990996361, -0.6163489818573], "z": [-0.216923445463181, 0.311559170484543], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.00282812025398016], "y": [-0.6163489818573], "z": [0.311559170484543], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [-0.21179812541521853], "y": [-0.1341693977434995], "z": [-0.15086311770330546], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0176963210105896], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [-0.21179812541521853, 0.154346406459808], "y": [-0.1341693977434995, -0.100275993347168], "z": [-0.15086311770330546, 0.0176963210105896], "type": "scatter3d"}], "name": "T3_I-3", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [-0.0160169582813978, -0.0241668876260519], "y": [-0.109332330524921, -0.691089034080505], "z": [-0.237597644329071, 0.311485826969147], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.0241668876260519], "y": [-0.691089034080505], "z": [0.311485826969147], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [-0.017035699495694532], "y": [-0.18205192176827723], "z": [-0.16896220730316225], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0176963210105896], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [-0.017035699495694532, 0.154346406459808], "y": [-0.18205192176827723, -0.100275993347168], "z": [-0.16896220730316225, 0.0176963210105896], "type": "scatter3d"}], "name": "T3_I-2", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.206050425767899, -0.094239629805088], "y": [-0.109003409743309, -0.726854741573334], "z": [-0.134704351425171, 0.27527791261673], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.094239629805088], "y": [-0.726854741573334], "z": [0.27527791261673], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.16851416420399512], "y": [-0.1862348357221866], "z": [-0.08345656211601796], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0176963210105896], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.16851416420399512, 0.154346406459808], "y": [-0.1862348357221866, -0.100275993347168], "z": [-0.08345656211601796, 0.0176963210105896], "type": "scatter3d"}], "name": "T3_I-1", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.206050425767899, -0.094239629805088], "y": [-0.109003409743309, -0.726854741573334], "z": [-0.134704351425171, 0.27527791261673], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.094239629805088], "y": [-0.726854741573334], "z": [0.27527791261673], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.16851416420399512], "y": [-0.1862348357221866], "z": [-0.08345656211601796], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0176963210105896], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.16851416420399512, 0.154346406459808], "y": [-0.1862348357221866, -0.100275993347168], "z": [-0.08345656211601796, 0.0176963210105896], "type": "scatter3d"}], "name": "T3_I0", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.394574582576752, -0.137453779578209], "y": [-0.260817259550095, -0.75514018535614], "z": [-0.0868636220693588, 0.248681753873825], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.137453779578209], "y": [-0.75514018535614], "z": [0.248681753873825], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.32807103899239415], "y": [-0.32260762371025703], "z": [-0.04492045113918251], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0176963210105896], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.32807103899239415, 0.154346406459808], "y": [-0.32260762371025703, -0.100275993347168], "z": [-0.04492045113918251, 0.0176963210105896], "type": "scatter3d"}], "name": "T3_I1", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.513293325901031, -0.175216823816299], "y": [-0.445569813251495, -0.761957228183746], "z": [-0.0449049063026905, 0.211712837219238], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.175216823816299], "y": [-0.761957228183746], "z": [0.211712837219238], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.42722954971505905], "y": [-0.4851182435512758], "z": [-0.012827685577785158], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0176963210105896], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.42722954971505905, 0.154346406459808], "y": [-0.4851182435512758, -0.100275993347168], "z": [-0.012827685577785158, 0.0176963210105896], "type": "scatter3d"}], "name": "T3_I2", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.593540489673615, -0.187926471233368], "y": [-0.604706287384033, -0.713684797286987], "z": [0.0301015228033066, 0.162137076258659], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.187926471233368], "y": [-0.713684797286987], "z": [0.162137076258659], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.4958571435221262], "y": [-0.6183285977803272], "z": [0.04660596293665957], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0176963210105896], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.4958571435221262, 0.154346406459808], "y": [-0.6183285977803272, -0.100275993347168], "z": [0.04660596293665957, 0.0176963210105896], "type": "scatter3d"}], "name": "T3_I3", "traces": [8, 9, 10, 11, 12]}, {"data": [{"legendgroup": "Bat", "line": {"color": "black", "width": 4}, "mode": "lines", "showlegend": false, "x": [0.587765395641327, -0.192626297473907], "y": [-0.822150707244873, -0.678554892539978], "z": [0.0267357341945171, 0.128565818071365], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "white", "line": {"color": "red", "width": 3}, "size": 10, "symbol": "circle"}, "mode": "markers", "showlegend": false, "x": [-0.192626297473907], "y": [-0.678554892539978], "z": [0.128565818071365], "type": "scatter3d"}, {"legendgroup": "Bat", "marker": {"color": "orange", "size": 7}, "mode": "markers", "showlegend": false, "x": [0.49021645828751953], "y": [-0.8042012348754275], "z": [0.03946449151019603], "type": "scatter3d"}, {"legendgroup": "Ball", "marker": {"color": "blue", "size": 7, "symbol": "x"}, "mode": "markers", "showlegend": false, "x": [0.154346406459808], "y": [-0.100275993347168], "z": [0.0176963210105896], "type": "scatter3d"}, {"legendgroup": "Bat", "line": {"color": "purple", "dash": "dash", "width": 3}, "mode": "lines", "showlegend": false, "x": [0.49021645828751953, 0.154346406459808], "y": [-0.8042012348754275, -0.100275993347168], "z": [0.03946449151019603, 0.0176963210105896], "type": "scatter3d"}], "name": "T3_I4", "traces": [8, 9, 10, 11, 12]}]};
    const trialInfo = {"1": [{"name": "T1_I-7", "index": -7, "is_min": false}, {"name": "T1_I-6", "index": -6, "is_min": false}, {"name": "T1_I-5", "index": -5, "is_min": false}, {"name": "T1_I-4", "index": -4, "is_min": false}, {"name": "T1_I-3", "index": -3, "is_min": false}, {"name": "T1_I-2", "index": -2, "is_min": true}, {"name": "T1_I-1", "index": -1, "is_min": false}, {"name": "T1_I0", "index": 0, "is_min": false}, {"name": "T1_I1", "index": 1, "is_min": false}, {"name": "T1_I2", "index": 2, "is_min": false}, {"name": "T1_I3", "index": 3, "is_min": false}], "2": [{"name": "T2_I-4", "index": -4, "is_min": false}, {"name": "T2_I-3", "index": -3, "is_min": false}, {"name": "T2_I-2", "index": -2, "is_min": false}, {"name": "T2_I-1", "index": -1, "is_min": false}, {"name": "T2_I0", "index": 0, "is_min": false}, {"name": "T2_I1", "index": 1, "is_min": true}, {"name": "T2_I2", "index": 2, "is_min": false}, {"name": "T2_I3", "index": 3, "is_min": false}, {"name": "T2_I4", "index": 4, "is_min": false}, {"name": "T2_I5", "index": 5, "is_min": false}, {"name": "T2_I6", "index": 6, "is_min": false}], "3": [{"name": "T3_I-6", "index": -6, "is_min": false}, {"name": "T3_I-5", "index": -5, "is_min": false}, {"name": "T3_I-4", "index": -4, "is_min": false}, {"name": "T3_I-3", "index": -3, "is_min": false}, {"name": "T3_I-2", "index": -2, "is_min": false}, {"name": "T3_I-1", "index": -1, "is_min": true}, {"name": "T3_I0", "index": 0, "is_min": false}, {"name": "T3_I1", "index": 1, "is_min": false}, {"name": "T3_I2", "index": 2, "is_min": false}, {"name": "T3_I3", "index": 3, "is_min": false}, {"name": "T3_I4", "index": 4, "is_min": false}]};  // { trial: [{name, index, is_min}, ...], ... }
    let currentTrial = "1";  // 文字列で扱う

    document.addEventListener("DOMContentLoaded", function() {
      const plotDiv = document.getElementById("plot");
      const slider = document.getElementById("frameSlider");
      const frameLabel = document.getElementById("frameLabel");
      const prevBtn = document.getElementById("prevBtn");
      const nextBtn = document.getElementById("nextBtn");

      // Plot を生成
      Plotly.newPlot(
        plotDiv,
        fig.data,
        fig.layout,
        {
          responsive: true,
          displayModeBar: true,
          scrollZoom: false
        }
      ).then(function(gd) {
        // frames を追加
        Plotly.addFrames(gd, fig.frames);

        // Trial ボタンにイベントを付与
        Object.keys(trialInfo).forEach(function(trialKey) {
          const btn = document.getElementById("trialBtn_" + trialKey);
          if (!btn) return;

          btn.addEventListener("click", function() {
            // active クラス切り替え
            document.querySelectorAll(".trial-btn").forEach(b => b.classList.remove("active"));
            btn.classList.add("active");

            currentTrial = trialKey;
            updateSliderForTrial(gd, currentTrial);
          });
        });

        // スライダー操作でフレーム更新（input = 動かしてる最中も追従）
        slider.addEventListener("input", function() {
          const idxInTrial = parseInt(slider.value);
          updateFrame(gd, currentTrial, idxInTrial);
        });

        // ±ボタン
        prevBtn.addEventListener("click", function() {
          const v = Math.max(parseInt(slider.min), parseInt(slider.value) - 1);
          slider.value = v;
          updateFrame(gd, currentTrial, v);
        });
        nextBtn.addEventListener("click", function() {
          const v = Math.min(parseInt(slider.max), parseInt(slider.value) + 1);
          slider.value = v;
          updateFrame(gd, currentTrial, v);
        });

        // 初期 Trial ボタンを active に
        const initBtn = document.getElementById("trialBtn_1");
        if (initBtn) initBtn.classList.add("active");

        // 初期表示
        updateSliderForTrial(gd, currentTrial);

        // ===== 関数群 =====
        function updateSliderForTrial(gd, trialKey) {
          const framesForTrial = trialInfo[trialKey];
          if (!framesForTrial || framesForTrial.length === 0) return;

          slider.min = 0;
          slider.max = framesForTrial.length - 1;

          // 初期は MIN フレーム（best_index）へ飛ばしたい場合：
          // is_min を探してそこへ。無ければ0。
          let initPos = 0;
          for (let i = 0; i < framesForTrial.length; i++) {
            if (framesForTrial[i].is_min) { initPos = i; break; }
          }
          slider.value = initPos;

          updateFrame(gd, trialKey, initPos);
        }

        function updateFrame(gd, trialKey, idxInTrial) {
          const framesForTrial = trialInfo[trialKey];
          if (!framesForTrial || framesForTrial.length === 0) return;

          const clampedIdx = Math.max(0, Math.min(idxInTrial, framesForTrial.length - 1));
          const frameInfo = framesForTrial[clampedIdx];
          const frameName = frameInfo.name;
          const indexValue = frameInfo.index;

          // ★重要：redraw:false でカメラ保持（スマホで戻りにくくする）
          Plotly.animate(gd, [frameName], {
            mode: "immediate",
            frame: { duration: 0, redraw: false },
            transition: { duration: 0 }
          });

          frameLabel.textContent =
            "Trial " + trialKey +
            " / frame index = " + indexValue +
            " (step " + clampedIdx + ")" +
            (frameInfo.is_min ? "  ★MIN" : "");
        }
      });
    });
  </script>
</body>
</html>
